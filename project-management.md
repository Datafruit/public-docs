# 数据管理
数据管理功能是整个分析平台的基础，负责管理维护数据接入、维度字段、数据指标等基础数据相关内容。

# 项目管理
项目是基础数据的容器，我们提供了多种方式将数据接入项目。同时，所有分析功能都是基于项目进行的。

## <span id = "create-project">创建项目</span>
![](/assets/project-management/1-1.png)
点击新建项目，进入新建项目页面。

![](/assets/project-management/1-2.png)
在填写项目名称后，可以选择以后再接数据，仅创建项目。而选择数据接入方式之后，即可点击下一步，开始数据接入工作。

***

## 数据接入
我们目前提供了两种数据接入方式：SDK接入、文件导入。
SDK接入：主要针对可视化埋点数据的接入（Web/Android/IOS）；
文件导入：主要针对小规模数据的导入；

此外，我们还提供了数据导入工具，便于进行大规模的数据导入。

### <span id = "sdk-access">SDK接入（可视化埋点）</span>
利用可视化交互界面进行页面事件埋点，无需写代码即可简单便捷的实现用户行为数据的采集。

#### APP可视化埋点—准备工作
![](/assets/project-management/2-1.png)

在创建项目时，选择数据接入方式为SDK接入，点击下一步即可进入SDK接入管理页面。
对于已创建的项目，则可由项目管理页面的“数据接入”按钮进入。

![](/assets/project-management/2-2.png)
SDK接入管理界面中，您可以看到针对iOS、Android、Web三种平台的接入管理。点击iOS/Android的接入按钮，右侧会出现接入说明。详细的SDK集成与使用说明，可以参见[开发者文档](developer-docs.md)部分。

当SDK在APP集成完成后，将装有此APP的手机连入WiFi，即可点击“检测SDK安装状态”按钮。

![](/assets/project-management/2-3.png)
SDK检测可能需要30秒至2分钟不等，若检测失败，可按照页面提示进行排查。
当SDK安装检测成功，即可开始可视化埋点。

#### APP可视化埋点—开始埋点
![](/assets/project-management/2-4.png)
开始可视化埋点界面，首先会出现一个二维码，用手机扫描二维码之后，打开页面，并按页面提示启动APP。

![](/assets/project-management/2-5.png)
开启手机相应APP后，电脑上的界面也会自动转至APP可视化埋点界面。
此界面主要由以下几个部分组成：
1.	页面设置：主要包括埋点页面名称的设置；
2.	事件设置：对页面载入事件和页面点击事件的埋点进行设置；
3.	可视化选取界面：展示APP的实时界面，可以用鼠标点击选择埋点元素；
4.	事件列表：展示当已埋点的事件列表，并提供快照截图，能直观查看埋点；
5.	埋点测试与发布按钮，退出埋点按钮。
 
**页面设置**

![](/assets/project-management/2-6.png)

页面加载后，此区域会读取页面路径，默认将自动获取页面名称（仅支持HTML）。若是原生页面，或需要特别定义页面名称时，可通过手动设置来命名此页面的名称。
页面分类功能，相当于赋予当前页面一个标签，可以将多个页面赋予相同的分类，便于后期的数据分析。

**原生页面元素埋点**

![](/assets/project-management/2-7.png)
首先，在可视化选取界面上点选需要埋点的元素；
左侧会自动获取此埋点的元素路径，现在我们可以对埋点事件进行设置：
1.	事件名称：埋点事件的名称，请使用辨识度较高的名称，便于今后查询；
2.	标签：用于对事件进行分类，便于跟踪；
3.	高级选项-上报数据：在当前埋点事件触发时，将页面中某个或多个指定可视元素的文本上报至自定义维度字段（需要在维度管理中预先创建维度）；详细操作会在HTML页面元素埋点一并讲述。

**HTML页面载入事件埋点**

![](/assets/project-management/2-8.png)

此功能可以通过向页面注入代码，在页面载入时，自动上报指定的内容到指定维度字段。
此功能仅支持HTML页面，函数自带了 `e`, `element`, `conf`, `instance`这些参数, 可以直接调用执行变量。  
  > **`e`:** 表示当前JS点击事件的Event对象  
  > **`element`:** 表示当前点击元素的DOM对象  
  > **`conf`:** SDK初始化的一些配置信息，如：`app_host`, `api_host`, `token`等  
  > **`instance`:** 当前初始化SDK的JS对象（sugoio对象） 
   
例如有如下需求：
  > 我们需要将当前点击元素的文本上报到自定义维度EventText上，同时要将搜索框中输入的内容上报到SearchText维度上。 
  > 我们可以注入如下代码来实现此需求：

```javascript
// 获取当前点击元素的text
var _clickText = element.innerText;  

//假设inpSearch为搜索框input框的id
var _searchText = document.getElementById('inpSearch').value;  

// 注：整个代码注入是一个函数内容体, 最终返回一个JSON对象，其中JSON对象的每个属性代表一个自定义维度的上报。
return { EventText: _clickText, SearchText: _searchText };  
```

**HTML页面元素埋点**
![](/assets/project-management/2-9.png)
首先，在可视化选取界面上点选需要埋点的元素；
左侧会自动获取此埋点的元素路径，现在我们可以对埋点事件进行设置：
1.	事件名称：埋点事件的名称，请使用辨识度较高的名称，便于今后查询；
2.	事件类型：固定为点击事件；
3.	标签：用于对事件进行分类，便于跟踪；
4.	同类有效：设置此埋点是否对页面中的同类元素一并生效。同类元素通过元素路径进行判别。例如下图中的新闻列表，每篇新闻的标题都可视为同类元素，同类元素会用红色边框圈选；
![](/assets/project-management/2-10.png)

5.	全局有效：设置此埋点是否对整个APP内的同一全局元素一并生效。全局元素通过元素路径进行判别，例如商城APP的购物车按钮，通常具有相同的元素路径，无论它位于哪个页面，都可视为同一个全局元素；
![](/assets/project-management/2-11.png)

6.	高级选项-上报数据：在当前埋点事件触发时，将页面中某个或多个指定可视元素的文本上报至自定义维度字段（需要在维度管理中预先创建维度）；
![](/assets/project-management/2-12.gif)

7.	高级选项-注入代码：与页面载入时的注入代码相似，实现的结果也与上报数据相同。但上报数据仅能用于可视元素，而采用代码注入的方式，可将页面上的不可视元素进行上报。

***

**Web可视化埋点—准备工作**

![](/assets/project-management/2-13.png)

在创建项目时，选择数据接入方式为SDK接入，点击下一步即可进入SDK接入管理页面。
对于已创建的项目，则可由项目管理页面的“数据接入”按钮进入。

![](/assets/project-management/2-14.png)
SDK接入管理界面中，您可以看到针对iOS、Android、Web三种平台的接入管理。点击iOS/Android的接入按钮，右侧会出现接入说明。详细的SDK集成与使用说明，可以参见[开发者文档](developer-docs.md)部分。

当SDK在APP集成完成后，将装有此APP的手机连入WiFi，即可点击“检测SDK安装状态”按钮。

![](/assets/project-management/2-15.png)
SDK检测可能需要30秒至2分钟不等，若检测失败，可按照页面提示进行排查。
当SDK安装检测成功，即可开始可视化埋点。

**Web可视化埋点—开始埋点**
![](/assets/project-management/2-16.png)
首次进行埋点时，需输入项目首页的地址。

![](/assets/project-management/2-17.png)
进入埋点界面后我们可以看到项目页面本身，以及埋点工具栏。

![](/assets/project-management/2-18.png)
点击“创建事件”按钮之后，可以使用鼠标点选要进行埋点的页面元素，被圈选的元素会被绿色外框标记。

![](/assets/project-management/2-19.png)

点击页面元素后，将自动打开埋点设置对话窗，对话窗中的内容包括：
1.	页面：当前页面的地址；
2.	元素：当前所选中的页面元素的路径；
3.	同类元素：设置此埋点是否对页面中的同类元素一并生效。同类元素通过元素路径进行判别，例如一个商品列表中，每个商品都可视为同类元素；
![](/assets/project-management/2-20.png)

4.	是否全局：设置此埋点是否对所有页面中的同类元素一并生效（例如下图全局导航的按钮）；
![](/assets/project-management/2-21.png)

5.	类型：埋点事件类型，包括：点击、改变、对焦；
6.	名称：埋点事件的名称，请使用辨识度较高的名称，便于今后查询；
7.	代码：根据需要填入js代码，例如可抓取页面指定内容，并上报至指定字段。  
 - 函数自带了 `e`, `element`, `conf`, `instance`这些参数, 可以直接调用执行变量。  
   > **`e`**: 表示当前JS点击事件的Event对象  
   > **`element`**: 表示当前点击元素的DOM对象  
   > **`conf`:** SDK初始化的一些配置信息，如：`app_host`, `api_host`, `token`等  
   > **`instance`:** 当前初始化SDK的JS对象（sugoio对象）  
  
例如有如下需求：  
   > 我们需要将当前点击元素的文本上报到自定义维度EventText上，同时要将搜索框中输入的内容上报到SearchText维度上。  
   > 我们可以注入如下代码来实现此需求：  

```javascript
// 获取当前点击元素的text
var _clickText = element.innerText;  

//假设inpSearch为搜索框input框的id
var _searchText = document.getElementById('inpSearch').value;  

// 注：整个代码注入是一个函数内容体, 最终返回一个JSON对象，其中JSON对象的每个属性代表一个自定义维度的上报。
return { EventText: _clickText, SearchText: _searchText };  
```

![](/assets/project-management/2-22.png)
已创建完毕的埋点事件会在页面中用色框进行标记。创建完毕的事件并不会直接生效，需要点击“部署事件”按钮，进行部署之后才会发挥作用。
已经创建的事件或完成的修改，即使不进行部署也都已保存，下次进入埋点页面可延续上次的工作。

***

### <span id = "file-access">文件导入</span>
文件导入主要是用于快速接入小规模数据，用以做诸如活动的临时数据分析和储存，目前文件导入支持CSV文件（UTF-8编码），未来将提供更多文件格式的支持。
为保证性能与可靠性，若需导入大量数据，请使用我们提供的[数据导入工具](data-import.md)。

![](/assets/project-management/2-23.png)

上传文件时，请确保CSV文件编码为UTF-8。同时，文件首行将判定为数据列标题，必须是英文或字母或下划线组成，不能以数字开头，不能包含中文，长度为2-50字节。

![](/assets/project-management/2-24.png)

文件上传成功后可以进行预览，并进行一些导入设置：
1.	导入启始行：由文件第几行开始导入。由于首行被强制判定为列标题，因此从第1行或第2行导入的结果是相同的；
2.	分隔符号：选择文件所使用的分隔符号；
3.	文本识别符号：选择文件所使用的文本识别符号，被符号标记的内容将被识别为文本而不是分隔符；
4.	数据格式：根据实际数据需求，设置每一列的数据格式；若选择了错误的数据格式，例如字符串数据选择了int格式，会造成导入失败；
5.	设置主时间字段：将某一列设置为时间维度列，即数据分析时的时间轴。此列的数据格式必须为date；
6.	选择导入数据列：可自由选择将那些列进行导入，默认为全部导入。

## <span id = "create-son">子项目</span>

以某个项目数据为基础，通过设置筛选条件，将符合条件的数据划归一个新的项目。新的项目即为原项目的子项目。
子项目主要用于实现对数据的分权管理，将项目内的指定数据对指定人员开放。

![](/assets/project-management/2-25.png)

上图展示了一个子项目创建的例子：
我们希望广州分部的人员只能看到项目数据中关于广州市的部分。于是我们用城市作为过滤条件，将广州市的数据过滤出来，创建了一个名为“数果智能行为项目-广州”的子项目。
 
![](/assets/project-management/2-26.png)

然后我们可以将新创建的子项目授权给指定的用户组。
